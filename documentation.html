<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <title>Neat Geo IP by kasramp</title>

  <link rel="stylesheet" href="stylesheets/styles.css">
  <link rel="stylesheet" href="stylesheets/github-light.css">
  <meta name="viewport" content="width=device-width">
<!--[if lt IE 9]>
<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
</head>
<body>
  <div class="wrapper">
    <h1>Neat Geo IP Documentation</h1>
    <p>
      This page consists of two subsections which are <br>
      <a href="#projectstructure">Project structure</a><br>
      <a href="#apidocumentation">API documentation</a><br>
    </p>
    <h2 id="projectstructure">Project structure</h2>
    <p>
      All the details about the project structure including source code explanation can be found here.
    </p>
    <p>
      The project is developed on Spring Boot which is suitable for making stand-alone and agile development. In below you can see the structure of this project. 
    </p>
    <code>
      <a href="https://github.com/kasramp/neatgeoip/tree/master">neatgeoip/</a><br>
      ├── <a href="https://github.com/kasramp/neatgeoip/tree/master/db">db</a><br>
      │   └── <a href="https://github.com/kasramp/neatgeoip/blob/master/db/GeoLite2-City.mmdb">GeoLite2-City.mmdb</a><br>
      ├── <a href="https://github.com/kasramp/neatgeoip/blob/master/pom.xml">pom.xml</a><br>
      ├── <a href="https://github.com/kasramp/neatgeoip/blob/master/README.md">README.md</a><br>
      ├── <a href="https://github.com/kasramp/neatgeoip/tree/master/sh">sh</a><br>
      │   └── <a href="https://github.com/kasramp/neatgeoip/blob/master/sh/openshift.sh">openshift.sh</a><br>
      └── <a href="https://github.com/kasramp/neatgeoip/tree/master/src/main/java/com/madadipouya/neatgeoip">src</a><br>
      &nbsp;&nbsp;&nbsp; └── <a href="https://github.com/kasramp/neatgeoip/tree/master/src/main/java/com/madadipouya/neatgeoip">main</a><br>
      &nbsp;&nbsp;&nbsp;    └── <a href="https://github.com/kasramp/neatgeoip/tree/master/src/main/java/com/madadipouya/neatgeoip">java</a><br>
      &nbsp;&nbsp;&nbsp;        └── <a href="https://github.com/kasramp/neatgeoip/tree/master/src/main/java/com/madadipouya/neatgeoip">com</a><br>
      &nbsp;&nbsp;&nbsp;        &nbsp;&nbsp;&nbsp; └── <a href="https://github.com/kasramp/neatgeoip/tree/master/src/main/java/com/madadipouya/neatgeoip">madadipouya</a><br>
      &nbsp;&nbsp;&nbsp;        &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; └── <a href="https://github.com/kasramp/neatgeoip/tree/master/src/main/java/com/madadipouya/neatgeoip">neatgeoip</a><br>
      &nbsp;&nbsp;&nbsp;        &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ├── <a href="https://github.com/kasramp/neatgeoip/blob/master/src/main/java/com/madadipouya/neatgeoip/Application.java">Application.java</a><br>
      &nbsp;&nbsp;&nbsp;        &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ├── <a href="https://github.com/kasramp/neatgeoip/tree/master/src/main/java/com/madadipouya/neatgeoip/rest">rest</a><br>
      &nbsp;&nbsp;&nbsp;        &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; │   ├── <a href="https://github.com/kasramp/neatgeoip/blob/master/src/main/java/com/madadipouya/neatgeoip/rest/CountryRestController.java">CountryRestController.java</a><br>
      &nbsp;&nbsp;&nbsp;        &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; │   └── <a href="https://github.com/kasramp/neatgeoip/blob/master/src/main/java/com/madadipouya/neatgeoip/rest/HomeRestController.java">HomeRestController.java</a><br>
      &nbsp;&nbsp;&nbsp;        &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ├── <a href="https://github.com/kasramp/neatgeoip/tree/master/src/main/java/com/madadipouya/neatgeoip/pojo">pojo</a><br>
      &nbsp;&nbsp;&nbsp;        &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; │   └── <a href="https://github.com/kasramp/neatgeoip/blob/master/src/main/java/com/madadipouya/neatgeoip/pojo/Country.java">Country.java</a><br>
      &nbsp;&nbsp;&nbsp;       &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;  ├── <a href="https://github.com/kasramp/neatgeoip/tree/master/src/main/java/com/madadipouya/neatgeoip/service">service</a><br>
      &nbsp;&nbsp;&nbsp;      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;│&nbsp;&nbsp;&nbsp;├── <a href="https://github.com/kasramp/neatgeoip/blob/master/src/main/java/com/madadipouya/neatgeoip/service/MaxMindService.java">MaxMindService.java</a><br>
      &nbsp;&nbsp;&nbsp;      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;│&nbsp;&nbsp;&nbsp;└── <a href="https://github.com/kasramp/neatgeoip/blob/master/src/main/java/com/madadipouya/neatgeoip/service/MaxMindServiceImpl.java">MaxMindServiceImpl.java</a><br>
      &nbsp;&nbsp;&nbsp;        &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; └── <a href="https://github.com/kasramp/neatgeoip/tree/master/src/main/java/com/madadipouya/neatgeoip/util/loader">util</a><br>
      &nbsp;&nbsp;&nbsp;        &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└── <a href="https://github.com/kasramp/neatgeoip/tree/master/src/main/java/com/madadipouya/neatgeoip/util/loader">loader</a><br>
      &nbsp;&nbsp;&nbsp;        &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└── <a href="https://github.com/kasramp/neatgeoip/blob/master/src/main/java/com/madadipouya/neatgeoip/util/loader/DatabaseFileLoader.java">DatabaseFileLoader.java</a><br>

    </p>
  </code>
  <p>
    As you can see the project structure is quite simple and straightforward.
  </p>
  <h3>
    db folder
  </h3>
  <p>
    db folder and its file used for looking up the country of the IP address. The database file belongs to MaxMind and is getting updated automatically monthly.
  </p>
  <h3>
    sh folder
  </h3>
  <p>
    sh folder contains openshift.sh file which is specific to the Openshift environment. Basically the script runs monthly to remove database file and restart the application, so the newly updated database will be downloaded. Basically, once the application started, it looks for the database file and if it cannot be found, it will download from MaxMind repository.
  </p>
  <h3>
    src folder
  </h3>
  <p>
    src folder contains the logic and source code of the service. In the following section the purpose of each source code is described in brief.
  </p>
  <h5>
    Application.java
  </h5>
  <p>
    Application.java starts Spring Boot application.
  </p>
  <h5>
    CountryRestController.java
  </h5>
  <p>
    CountryRestController.java refers to service at <strong>"/getCountry"</strong> which looks up for the country of the given IP address.
  </p>
  <h5>
    HomeRestController.java
  </h5>
  <p>
    HomeRestController.java refers to service at <strong>"/"</strong> which redirects user to Neat Geo IP Github page.
  </p>
  <h5>
    Country.java
  </h5>
  <p>
    Country.java is the content of the service which returns to the user. The content includes name (countryName), isoCode, name of the country in other languages (German, Russian, Portuguese [Brazil], Japanese, English, French, Chinese, and Spanish). The final parameter is error in which demonstrates occurred error in the API call.
  </p>
  <h5>
    MaxMindService.java
  </h5>
  <p>
    MaxMindService.java is an interface to get the country name of the IP.
  </p>
  <h5>
    MaxMindServiceImpl.java
  </h5>
  <p>
    MaxMindServiceImpl.java is the implementation of MaxMindService.java which utilizes MaxMind library as.
  </p>
  <h5>
    DatabaseFileLoader.java
  </h5>
  <p>
    DatabaseFileLoader.java contains the logic of loading the database file based on environment application running. If the database file exists in the local repository ("/db" folder), it uses the file, otherwise, it attempts to download the file from MaxMind server and unzip it as well. The logic of this class is optimized for Openshift and usual normal environment. Keep note that the database file is loaded into memory, if your instance has shortage of the memory, comment <code>`line 57`</code> in <code>LoadDbFile.java</code>.
  </p>
  <h2 id = "apidocumentation">
    API documentation
  </h2>
  <p>
    This section describes how to use and call the Neat Geo IP Rest API. 
  </p>
  <h3>
    API description
  </h3>
  <p>
    Basically Neat Geo IP provides only one API to use. The API method is <strong>getCountry</strong> which requires <code>ip</code> parameter. The API returns a JSON string as response. 
  </p>
  <p>
    The API URL is located at : <br>
    <a href="http://neatgeoip-api.madadipouya.com/">http://neatgeoip-api.madadipouya.com/</a>
  </p>
  <p>
    To call the API use <a href="http://www.utf-8.com/">UTF-8</a>. For instance, <br>
    <a href="http://neatgeoip-api.madadipouya.com/getCountry?ip=WW.XX.YY.ZZ">http://neatgeoip-api.madadipouya.com/getCountry?ip=WW.XX.YY.ZZ</a>
  </p>
  <p>
    Consequently when you call the above API method, you get similar response to following : 
  </p>
  <code>
    <pre>

{
    "name":"FooBar",
    "isoCode":"Foo",
    "names":
    {
        "de":"Foo",
        "ru":"Foo",
        "pt-BR":"Foo",
        "ja":"Foo",
        "en":"Foo",
        "fr":"Foo",
        "zh-CN":"Foo",
        "es":"Foo"
    },
    "errors":[]
}
    </pre>
</code>
<h3>
Example
</h3>
<p>
A sample API call of getCountry method for the IP <strong>"5.254.65.130"</strong>.<br>
<a href="http://neatgeoip-api.madadipouya.com/getCountry?ip=5.254.65.130">
http://neatgeoip-api.madadipouya.com/getCountry?ip=5.254.65.130</a>
</p>
<p>
The response of the API call : 
</p>
<code>
  <pre>

{
    "name":"Turkey",
    "isoCode":"TR",
    "names":
    {
        "de":"Türkei",
        "ru":"Турция",
        "pt-BR":"Turquia",
        "ja":"トルコ共和国",
        "en":"Turkey",
        "fr":"Turquie",
        "zh-CN":"土耳其",
        "es":"Turquía"
    },
    "errors":[]
}
  </pre>
</code>
<p>
If the location cannot be retrieved "Country not found!" error will be returned in JSON response.
</p>
<code>
<pre>
{
   "name":"",
   "isoCode":"",
   "names":{},
   "errors":["Country not found!"]
}
</pre>
</code>
</div>
<div class="wrapper">
  <hr>
  This page is maintained by <a href="https://github.com/kasramp">kasramp</a><br>
  <small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small>
</div>
<script src="javascripts/scale.fix.js"></script>    
</body>
</html>
